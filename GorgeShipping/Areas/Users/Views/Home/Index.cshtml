@using GorgeShipping.Models
@model IEnumerable<GorgeShipping.Models.User>


<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Index</title>
</head>
<body>
    <div class="form-group row">
        <div class="col-3"></div>
        <div class="col">
            <br />
            <h2 class="text-info text-center">Gorge Shipping</h2>

            <div class="row" style="padding-top:10px">

                <div class="col">

                    <div class="dx-field-label">Find by Phone Number :</div>
                    <br />
                    <div class="active-3 mb-4">
                        <input class="form-control mr-sm-2" type="text" id="Input"
                               onkeyup="function()" placeholder="Search Phone Number" aria-label="Search" />
                    </div>
                    <a asp-action="Index">Back to full List</a>

                </div>

            </div>

            <br />

            <div class="text-justify">
                <a asp-action="Create" class="btn btn-outline-info"> <i class="fas fa-user-plus"></i> &nbsp;New!</a>
            </div>

            <br /> <br />
            <div class="col">
                <table  class="table text-center  table-bordered table-sm">
                    <tr class="table-info table-striped text-center">
                        <th>
                            @Html.DisplayNameFor(m => m.Name)
                        </th>
                        <th>
                            @Html.DisplayNameFor(m => m.Email)
                        </th>
                        <th>
                            @Html.DisplayNameFor(m => m.FirstOrDefault().TelephoneNumbers.FirstOrDefault().TelNumber)
                        </th>
                        <th>
                            Phone Number 2
                        </th>

                    </tr>


                    @foreach (var user in Model)
                    {
                        <tbody id="myTable">
                            <tr data-href="@Url.Action("Detail/"+user.id)">
                                <td>
                                    @Html.DisplayFor(m => user.Name)
                                </td>
                                <td>
                                    @Html.DisplayFor(m => user.Email)
                                </td>
                                <td>
                                    @Html.DisplayFor(m => user.TelDefault.TelNumber)
                                </td>
                                @if (user.TelephoneNumbers.LastOrDefault().TelNumber != user.TelDefault.TelNumber)
                                {
                                    <td>
                                        @Html.DisplayFor(m => user.TelephoneNumbers.LastOrDefault().TelNumber)
                                    </td>
                                }
                                else
                                {
                                    <td></td>
                                }
                            </tr>
                        </tbody>
                    }
                </table>
            </div>
        </div>
        <div class="col-3"></div>
    </div>

    @*<script>
            function SearchFunction() {
                var input, filter, table, tr, td, i, txtValue;

                input = document.getElementById("myInput");
                table = document.getElementById("myTable");

                filter = input.value.toUpperCase();

                tr = table.getElementsByTagName("tr");

                for (i = 0; i < tr.length; i++) {
                    td = tr[i].getElementsByTagName("td")[2];

                    if (td) {
                        txtValue = td.textContent || td.innerText;
                        if (txtValue.toUpperCase().indexOf(filter) > -1) {
                            tr[i].style.display = "";
                        }
                        else {
                            tr[i].style.display = "none";
                        }
                    }
                }
            }
        </script>*@

    <script>
        $(document).ready(function () {
            $("#Input").on("keyup", function () {
                var value = $(this).val().toLowerCase();
                $("#myTable tr").filter(function () {
                    $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
                });
            });
        });
    </script>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const rows = document.querySelectorAll("tr[data-href]");

            rows.forEach(row => {
                row.addEventListener("click", () => {
                    window.location.href = row.dataset.href;
                });
            })
        });
    </script>

    <style>
        tr[data-href] {
            cursor: pointer;
        }
    </style>
</body>
</html>
